document.getElementById("qrForm").addEventListener("submit", e => { e.preventDefault(); var text = document.getElementById("text").value; var xhr = new XMLHttpRequest(); xhr.open("POST", "/qr", true); xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); xhr.onreadystatechange = () => { if (xhr.readyState === 4 && xhr.status === 200) { var response = JSON.parse(xhr.responseText); var qrImage = document.getElementById("qrImage"); qrImage.src = response.qrCode; document.getElementById("qrResult").style.display = "block"; var downloadButton = document.getElementById("downloadButton"); downloadButton.style.display = "block"; downloadButton.addEventListener("click", () => { var link = document.createElement('a'); link.href = qrImage.src; link.download = 'qr-code.png'; link.click(); }); }}; xhr.send("text=" + encodeURIComponent(text)); });
